<?php

/**
 * @file config.inc.php 
 * Server configuration directives
 *
 * @defgroup confdir Configuration Directives
 * Configuration directives for CAS server
 * @{
 */
/**
  Absolute path to your CAS install directory.
 */
define('SimpleSamlPATH', '/path/to/simplesamlphp/lib');
define('ENT_SERVER', 'https://www.dev.laclasse.com');
// Add lib/ directory in the include path
set_include_path('.'.PATH_SEPARATOR.__DIR__.PATH_SEPARATOR.__DIR__.'/lib/'.PATH_SEPARATOR.get_include_path());

define('ENT_SERVER', 'URL of the ENT server'); //https://www.dev.laclasse.com
define('CAS_URL', 'URL of CAS server'); // http://..../sso
define('SERVICE', ENT_SERVER . '/pls/education/!page.laclasse');

/** CAS protocol compatibility
 * @param CAS_VERSION Possible values are : 1.0, 2.0.
 * @note Not used ATM
 */
$CONFIG['CAS_VERSION'] = '2.0';
//-------------------------------------------------------------------
// DATABASE BACKEND TYPE 
$CONFIG['DATABASE'] = 'WEBAPI';
//-------------------------------------------------------------------
//------------------------------------------------------------------------------
// Constantes de connexion au Backend.
//------------------------------------------------------------------------------

// Database name
define('BACKEND_DBNAME', 'http://my.api.server.lan/api');
// Database username
define('BACKEND_DBUSER', 'some_db_user');
// Database password
define('BACKEND_DBPASS', 'incredible_hard_to_guess_password');

//------------------------------------------------------------------
//php simple saml authentication sources in authSource.php
//-------------------------------------------------------------------
// Profile Parent Eleve Metadata name  in /simplesamlphp/config authSource.php�
$CONFIG['PARENT_ELEVE_SOURCE'] = 'simpleexample';
// Profile Agent Metadata name in /simplesamlphp/config authSource.php
$CONFIG['AGENT_SOURCE'] = 'Agentportal';
//-------------------------------------------------------------------

/* * **** Debugging*** */
/* Values 
  DEBUG  = 1;
  INFO      = 2;
  WARN      = 3;
  ERROR   = 4;
  FATAL   = 5;
  OFF   = 6;  //no log
 */
$CONFIG['DEBUG_LEVEL'] = 1;
$CONFIG['DEBUG_FILE'] = '/tmp/log.txt';
//----------------------------------------------------------------------
/** Redis server array
 * Redis is the datastorage for versions above 1.1
 * @param REDIS_SERVERS Array of servers. Each server is an array of (host, port).
 * Thus, REDIS_SERVERS contains an array of arrays. It is looped over
 * and each entry is as parameter to
 * Rediska::addServer
 * @param REDIS_ROOT String containing the base root for ALL Redis get/set operations
 * related to ticket handling.
 */
$CONFIG['REDIS_SERVERS'] = array(array('localhost', 6379));
$CONFIG['REDIS_ROOT'] = 'org.example.sso.tickets.';

/**
  Timeout in second for each kind of ticket
  ST for ServiceTicket : Could be short too because it  is a one shot ticket tha have to
  be validated : 4 minutes for example
  TGT for TicketGrantingTicket : Could be long : 8 hours for example
 */
$CONFIG['ST_TIMOUT'] = 4 * 60;
$CONFIG['TGT_TIMOUT'] = 8 * 60 * 60;
$CONFIG['PT_TIMOUT'] = 4 * 60;
$CONFIG['PGT_TIMOUT'] = 4 * 60;

/**
  Logging and tracker config
  The logging format is as follows (All field are Tab separated):
  CODE USERNAME IP DATE
  Available codes are :
  => LOGIN_SUCCESS
  => LOGIN_FAILURE
  => LOGOUT_SUCCESS
  => TRACKING_ALERT
 */

// Mail of admin who need to receive the tracking alert 
$CONFIG['MAIL_ADMIN'] = "you@yourdomain.com";

/*
 * Authentication backend
 */

include_once('lib/authentication.php');

//--------------------------------------------------------------------------------------------
// Requete SQL de validation des login/pwd
//------------------------------------------------------------------------------
define('SQL_AUTH', 'select user from table having certain login and password');

//------------------------------------------------------------------------------
// Requete SQL d'extration des donn�es pour le jeton d'authentification CAS.
//
// You can define one Attributes provider per authorized service
// By default, the sql statment for DB backend is SQL_FOR_ATTRIBUTES
//------------------------------------------------------------------------------
define('SQL_FOR_ATTRIBUTES', 'select whatever field you need                 
		from whatever, table, is, required
		where u.login = :LOGIN and few joins');


